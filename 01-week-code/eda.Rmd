---
title: "Exploratory Data Analysis"
author: "Nicholas Noel"
date: '2022-06-28'
output: html_document
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)
```

```{r}
library(haven)
library(readxl)
library(ggplot2)
library(tidyverse)
library(dplyr)
library(janitor)
demographic_background <- read_dta("../data/wave-1-(9-mo)/1_DEM_w1.dta")
media_tech <- read_dta("../data/wave-1-(9-mo)/10_MT_w1.dta")
overall_background <- read_dta("../data/wave-1-(9-mo)/2_BCK_w1.dta")
scores_w1 <- read_dta("../data/wave-1-(9-mo)/26_PLS_w1.dta")
w1_codebook <- read_excel("../data/wave-1-(9-mo)/BB2_w1_codebook.xls.xlsx")

wave_2 <- read_dta("../data/wave-2-(12-mo)/31_BIT_w2.dta")
#wave_2_codebook <- read_excel("../data/wave-2-(12-mo)/BB2_w2_codebook.xls.xlsx")

wave_6 <- read_dta("../data/wave-6-(24-mo)/BB2_W6_BIT.dta")
#wave_6_codebook <- read_excel("../data/wave-6-(24-mo)/BB2_w6_BITSE_codebook.xls.xlsx")
```

# Aubree's code

```{r}

#learning to give cells names 
overall_background <- 
overall_background %>% 
  mutate(bg02a = as.factor(bg02a),
         bg02a = case_when(
           bg02a == -777 ~ "planned skip",
         bg02a == -111 ~ "drop",
         bg02a == -222 ~ "different version",
         bg02a == -333 ~ "other parent",
         bg02a == -444 ~ "unable",
         bg02a == -555 ~ "unsure",
         bg02a == -666 ~ "refused",
         bg02a == -888 ~ "error",
         bg02a == -999 ~ "missing tool") )

#subsetting data 

public_assistance <- overall_background %>% 
  select(bg12a, bg12b, bg12c,
         bg12d, bg12e, bg12f, bg12g,
         bg12h, bg12i, bg12j, bg12k, bg12o,
         bg12otxt, bg15, assistance)


```

# Chandra's code

```{r}
glimpse(media_tech)

```

```{r}
# total na values per column
colSums(is.na(media_tech))

# percentage na values per column
colMeans(is.na(media_tech))
```

```{r}
media_tech_cleaned <- media_tech %>%
  transmute(child_id = as.character(childid),
         par_id = as.character(parid),
         q4a = as.factor(case_when(
           mt04a == 1 ~ "never_or_rarely",
           mt04a == 2 ~ "some_days_each_week",
           mt04a == 3 ~ "most_days_each_week",
           mt04a == 4 ~ "once_a_day",
           mt04a == 5 ~ "several_times_each_day")),
         q4b = as.factor(case_when(
           mt04b == 1 ~ "never_or_rarely",
           mt04b == 2 ~ "some_days_each_week",
           mt04b == 3 ~ "most_days_each_week",
           mt04b == 4 ~ "once_a_day",
           mt04b == 5 ~ "several_times_each_day")),
         q4c = as.factor(case_when(
           mt04c == 1 ~ "never_or_rarely",
           mt04c == 2 ~ "some_days_each_week",
           mt04c == 3 ~ "most_days_each_week",
           mt04c == 4 ~ "once_a_day",
           mt04c == 5 ~ "several_times_each_day")),
         q4d = as.factor(case_when(
           mt04d == 1 ~ "never_or_rarely",
           mt04d == 2 ~ "some_days_each_week",
           mt04d == 3 ~ "most_days_each_week",
           mt04d == 4 ~ "once_a_day",
           mt04d == 5 ~ "several_times_each_day")),
         q5a = as.factor(case_when(
           mt05a == 1 ~ "never_or_rarely",
           mt05a == 2 ~ "some_days_each_week",
           mt05a == 3 ~ "most_days_each_week",
           mt05a == 4 ~ "once_a_day",
           mt05a == 5 ~ "several_times_each_day")),
         q5b = as.factor(case_when(
           mt05b == 1 ~ "never_or_rarely",
           mt05b == 2 ~ "some_days_each_week",
           mt05b == 3 ~ "most_days_each_week",
           mt05b == 4 ~ "once_a_day",
           mt05b == 5 ~ "several_times_each_day")),
         q5c = as.factor(case_when(
           mt05c == 1 ~ "never_or_rarely",
           mt05c == 2 ~ "some_days_each_week",
           mt05c == 3 ~ "most_days_each_week",
           mt05c == 4 ~ "once_a_day",
           mt05c == 5 ~ "several_times_each_day")),
         q5d = as.factor(case_when(
           mt05d == 1 ~ "never_or_rarely",
           mt05d == 2 ~ "some_days_each_week",
           mt05d == 3 ~ "most_days_each_week",
           mt05d == 4 ~ "once_a_day",
           mt05d == 5 ~ "several_times_each_day")),
         q5e = as.factor(case_when(
           mt05e == 1 ~ "never_or_rarely",
           mt05e == 2 ~ "some_days_each_week",
           mt05e == 3 ~ "most_days_each_week",
           mt05e == 4 ~ "once_a_day",
           mt05e == 5 ~ "several_times_each_day")),
         q5f = as.factor(case_when(
           mt05f == 1 ~ "never_or_rarely",
           mt05f == 2 ~ "some_days_each_week",
           mt05f == 3 ~ "most_days_each_week",
           mt05f == 4 ~ "once_a_day",
           mt05f == 5 ~ "several_times_each_day")),
         q5g = as.factor(case_when(
           mt05g == 1 ~ "never_or_rarely",
           mt05g == 2 ~ "some_days_each_week",
           mt05g == 3 ~ "most_days_each_week",
           mt05g == 4 ~ "once_a_day",
           mt05g == 5 ~ "several_times_each_day")),
         q6a = as.logical(case_when(
           mt06a == 0 ~ 0,
           mt06a == 1 ~ 1)),
         q6b = as.logical(case_when(
           mt06b == 0 ~ 0,
           mt06b == 1 ~ 1)),
         q6c = as.logical(case_when(
           mt06c == 0 ~ 0,
           mt06c == 1 ~ 1)),
         q6d = as.logical(case_when(
           mt06d == 0 ~ 0,
           mt06d == 1 ~ 1)),
         q6e = as.logical(case_when(
           mt06e == 0 ~ 0,
           mt06e == 1 ~ 1)),
         q6f = as.logical(case_when(
           mt06f == 0 ~ 0,
           mt06f == 1 ~ 1)),
         q6g = as.logical(case_when(
           mt06g == 0 ~ 0,
           mt06g == 1 ~ 1)),
         q6h = as.logical(case_when(
           mt06h == 0 ~ 0,
           mt06h == 1 ~ 1)),
         q6i = as.logical(case_when(
           mt06i == 0 ~ 0,
           mt06i == 1 ~ 1)),
         q7a = as.factor(case_when(
           mt07a == 1 ~ "strongly_disagree",
           mt07a == 2 ~ "disagree",
           mt07a == 3 ~ "agree",
           mt07a == 4 ~ "strongly_agree")),
         q8 = as.logical(case_when(
           mt08 == 0 ~ 0,
           mt08 == 1 ~ 1)),
         q5hz = as.factor(case_when(
           mtz05hz == 1 ~ "never_or_rarely",
           mtz05hz == 2 ~ "some_days_each_week",
           mtz05hz == 3 ~ "most_days_each_week",
           mtz05hz == 4 ~ "once_a_day",
           mtz05hz == 5 ~ "several_times_each_day")),
         q5iz = as.factor(case_when(
           mtz05iz == 1 ~ "never_or_rarely",
           mtz05iz == 2 ~ "some_days_each_week",
           mtz05iz == 3 ~ "most_days_each_week",
           mtz05iz == 4 ~ "once_a_day",
           mtz05iz == 5 ~ "several_times_each_day")),
         q5jz = as.factor(case_when(
           mtz05jz == 1 ~ "never_or_rarely",
           mtz05jz == 2 ~ "some_days_each_week",
           mtz05jz == 3 ~ "most_days_each_week",
           mtz05jz == 4 ~ "once_a_day",
           mtz05jz == 5 ~ "several_times_each_day")),
         q5kz = as.factor(case_when(
           mtz05kz == 1 ~ "never_or_rarely",
           mtz05kz == 2 ~ "some_days_each_week",
           mtz05kz == 3 ~ "most_days_each_week",
           mtz05kz == 4 ~ "once_a_day",
           mtz05kz == 5 ~ "several_times_each_day")),
         q5lz = as.factor(case_when(
           mtz05lz == 1 ~ "never_or_rarely",
           mtz05lz == 2 ~ "some_days_each_week",
           mtz05lz == 3 ~ "most_days_each_week",
           mtz05lz == 4 ~ "once_a_day",
           mtz05lz == 5 ~ "several_times_each_day")),
         n_devices = MTndevices,
         tv_exposure = MTtvexposure,
         solo = MTsolomedia,
         passive = MTpassive,
         coop = MTcouse,
         mealtimes = MTmealtimes,
         behavior_management = MTdcbhv,
         possitive_beliefs_media = MTbeliefs,
         educational_benefits = MTeduc,
         digital_babysitting = MTbabysit,
         daily_use = MTdailyuse
)
```



# Deborah's code

```{r}

```

# James' code

## clean data

```{r}
scores_w1 <- clean_names(scores_w1)
glimpse(scores_w1)
```
```{r}
scores_w1 <-  scores_w1 %>% 
  mutate(child_id = as.character(childid),
         par_id = as.character(parid),
         father = pargen == 1,
        language_26_PLS_w1 = as.factor(case_when(
          language_26_pls_w1 == 0 ~ "english",
          language_26_pls_w1 == 1 ~ "spanish"
        )),
        site = as.factor(case_when(
          site == 1 ~ "UMD",
          site == 2 ~ "UCI"
        )))
```

### Variable meaning

|variable name| description|
|-------------|------------|
|childid| Child ID|
|parid| Parent ID|
|wave| wave index|
|version_26_PLS_w1| version of this form? (we definitely dont need this)|
|pargen| Parent gender|
|site | no use|
|language_26_PLS_w1| From language|
|plsacraw| Auditory Comprehension raw score|
|plsecraw| Expressive Communication raw score|
|plsraw| Total raw score (AC raw  + EC raw)|
|plsacss| Auditory Comprehension standard score|
|plsacpr| Auditory Comprehension percentile rank|
|plsecss| Expressive Communication standard score|
|plsecpr| Expressive Communication percentile rank|
|plsss| Total Standard Score|
|plspr| Total score percentile rank|

## modeling w1_scores

```{r}
model_score <- scores_w1 %>%
  select(child_id, par_id, father, language = language_26_PLS_w1, auditory_comprehension_score = plsacss, expressive_communication_score = plsecss, total_score = plsss)
```


# Nick's code

```{r}

parent_demographic <- demographic_background %>%
  mutate(child_id = as.character(childid),
         par_id = as.character(parid),
         language = case_when(
           language == 1 ~1, 
           language == 0 ~ 0),
         span_lang_form = as.logical(language),
         pargen = case_when(
           pargen == 0 ~ 0,
           pargen == 1 ~ 1),
         father = as.logical(pargen),
         data_site = as.character(site),
         par_ethnicity= as.character(dem04),
         par_ethnicity = case_when(
            dem04 == 1 ~ "White",
            dem04 == 2 ~ "African American",
            dem04 == 4 ~ "Asian/Asian American",
            dem04 == 5 ~ "Middle Eastern",
            dem04 == 7 ~ "Native Haiwaiian/Pacific Islander",
            dem04 == 8 ~ "Hispanic/Latino",
            dem04 == 9 ~ "Other",
            dem04 == 10 ~ "multiracial"),
         dem05 = case_when(
           dem05 == 0 ~ 0,
           dem05 == 1 ~ 1),
         par_us_born = as.logical(dem05),
         par_language = as.character(dem06),
         par_language = case_when(
           dem06 == 1 ~ "English",
           dem06 == 2 ~ "Spanish",
           dem06 == 3 ~ "English/Spanish",
           dem06 == 5 ~ "English/Other",
           dem06 == 6 ~ "multilingual"),
         dem08 = case_when(
           dem08 == 0 ~ 0,
           dem08 == 1 ~1),
         chi_girl = as.logical(dem08),
         birth_time = case_when(
           dem10 == 1 ~ "on time",
           dem10 == 2 ~ "early",
           dem10 == 3 ~ "late"),
         dem11 = case_when(dem11 == 0 ~ 0, dem11 == 1 ~1),
         planned_preg = as.logical(dem11),
         dem16 = case_when(
           dem16 == 1 ~ "White",
           dem16 == 2 ~ "Black/AA",
           dem16 == 3 ~ "Asian",
           dem16 == 8 ~ "Hispanic/Latino",
           dem16 == 9 ~ "Other",
           dem16 == 10 ~ "Multiracial"),
         chi_ethnicity = as.character(dem16),
         dem17 = case_when(
           dem17 == 1 ~ "English",
           dem17 == 2 ~ "Spanish",
           dem17 == 3 ~ "English/Spanish",
           dem17 == 4 ~ "Vietnamese",
           dem17 == 5 ~ "English/Other", 
           dem17 == 6 ~ "Multilingual",
           dem17 == 7 ~ "Other"),
         chi_par_lang = as.character(dem17),
         dem19 = case_when(
           dem19 == 1 ~ "English",
           dem19 == 2 ~ "Spanish",
           dem19 == 3 ~ "English/Spanish",
           dem19 == 4 ~ "Vietnamese",
           dem19 == 5 ~ "English/Other",
           dem19 == 6 ~ "Multilingual",
           dem19 == 7 ~ "Other"),
         relatives_lang = as.character(dem19) ) %>% 
  select(child_id, par_id, span_lang_form, father,data_site, 
         par_ethnicity,par_us_born, par_language, chi_girl, 
         birth_time, planned_preg, chi_ethnicity, chi_par_lang, 
         relatives_lang )
  

```

```{r}
  
ggplot(data = parent_demographic, aes( 
  x= par_ethnicity)) +
geom_bar()
parent_demographic %>% 
  ggplot(aes(x = planned_preg)) + 
  geom_bar()
parent_demographic %>% 
  ggplot(aes(x = chi_ethnicity)) + 
  geom_bar()
parent_demographic %>% 
  ggplot(aes(x = chi_par_lang)) + 
  geom_bar()
parent_demographic %>% 
  ggplot(aes(x = par_language)) + 
  geom_bar()
parent_demographic %>% 
  ggplot(aes(x = par_us_born)) + 
  geom_bar()
```

# James'

```{r}
model_score_demographic = full_join(model_score, parent_demographic, by=c("child_id", "par_id"))
```

```{r}
model_score_demographic %>% 
  glimpse()
```

```{r}
model_score_demographic %>% 
  ggplot(aes(x = chi_ethnicity,
             y = total_score))+
  geom_col()
```

