---
title: "Exploratory Data Analysis"
author: "Nicholas Noel"
date: '2022-06-28'
output: html_document
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)
```

```{r}
library(forcats)
library(haven)
library(readxl)
library(ggplot2)
library(tidyverse)
library(dplyr)
library(janitor)
demographic_background <- read_dta("../data/wave-1-(9-mo)/1_DEM_w1.dta")
media_tech <- read_dta("../data/wave-1-(9-mo)/10_MT_w1.dta")
overall_background <- read_dta("../data/wave-1-(9-mo)/2_BCK_w1.dta")
scores_w1 <- read_dta("../data/wave-1-(9-mo)/26_PLS_w1.dta")
w1_codebook <- read_excel("../data/wave-1-(9-mo)/BB2_w1_codebook.xls.xlsx")

wave_2 <- read_dta("../data/wave-2-(12-mo)/31_BIT_w2.dta")
#wave_2_codebook <- read_excel("../data/wave-2-(12-mo)/BB2_w2_codebook.xls.xlsx")

wave_6 <- read_dta("../data/wave-6-(24-mo)/BB2_W6_BIT.dta")
#wave_6_codebook <- read_excel("../data/wave-6-(24-mo)/BB2_w6_BITSE_codebook.xls.xlsx")
```

# Aubree's code

```{r}

#learning to give cells names 
overall_background <- 
overall_background %>% 
  mutate(bg02a = as.factor(bg02a),
         bg02a = case_when(
           bg02a == -777 ~ "planned skip",
         bg02a == -111 ~ "drop",
         bg02a == -222 ~ "different version",
         bg02a == -333 ~ "other parent",
         bg02a == -444 ~ "unable",
         bg02a == -555 ~ "unsure",
         bg02a == -666 ~ "refused",
         bg02a == -888 ~ "error",
         bg02a == -999 ~ "missing tool") )

#subsetting data 

public_assistance_w1 <- overall_background %>% 
 mutate(par_id = as.character(parid),
         child_id = as.character(childid),
         wave = as.factor(wave),
         par_gen = case_when(
           pargen == 0 ~ 0,
           pargen == 1 ~ 1),
         state_welfare = case_when(bg12a == 0 ~ 0,
                                   bg12a == 1~1),
         unemployment_insurance = case_when(bg12b== 0 ~ 0,
                                   bg12b == 1~1),
         food_stamp = case_when(bg12c == 0 ~ 0,
                                   bg12c == 1~1),
         wic = case_when(bg12d == 0 ~ 0,
                                   bg12d == 1~1),
         child_support = case_when(bg12e == 0 ~ 0,
                                   bg12e == 1~1),
         ssi_and_ssdi = case_when(bg12f == 0 ~ 0,
                                   bg12f == 1~1),
         adoption_assistance = case_when(bg12g == 0 ~ 0,
                                   bg12g == 1~1),
         utility_assistance = case_when(bg12h == 0 ~ 0,
                                   bg12h == 1~1), 
         childcare_subsidy = case_when(bg12i == 0 ~ 0,
                                   bg12i == 1~1),
         vertan_benefit = case_when(bg12j == 0 ~ 0,
                                   bg12j == 1~1),
         medical_assistance = case_when(bg12k == 0 ~ 0,
                                   bg12k == 1~1),
         none = case_when(bg12l == 0 ~ 0,
                                   bg12l == 1~1),
         other = case_when(bg12o == 0 ~ 0,
                                   bg12o == 1~1),
         #other_specify = as.character(bg12oxtxt),
         assistance = as.factor(assistance))

public_assistance_w1 <- public_assistance_w1%>% 
  select(par_id, child_id, state_welfare, unemployment_insurance, 
         food_stamp, wic, child_support, ssi_and_ssdi, adoption_assistance, 
         utility_assistance, childcare_subsidy, vertan_benefit, 
         medical_assistance, none, other, assistance)


access_to_childcare_w1 <- overall_background %>% 
  mutate(par_id = as.character(parid),
         child_id = as.character(childid),
         wave = as.factor(wave),
         par_gen = case_when(
           pargen == 0 ~ 0,
           pargen == 1 ~ 1),
         household_others = case_when(bg04 == 0 ~ 0,
                                      bg04 == 1 ~ 1),
         adult_others = as.integer(bg04a),
         children_others = as.integer(bg04b),
        know_others = as.integer(bg04d),
        marital_status = case_when(
             bg05 == 0 ~ "Nevermarries/Single",
             bg05 == 1 ~ "Now Married",
             bg05 == 2 ~ "Living as Married/Engaged",
             bg05 == 3 ~ "Divorced"),
        recieve_childcare = case_when(bg06 == 0 ~ 0, bg06 == 1 ~ 1),
        childcare_center = case_when(bg06a == 0 ~ 0, bg06a == 1 ~ 1),
        homebased_care = case_when(bg06b == 0 ~ 0, bg06b == 1 ~ 1),
        relative_care = case_when(bg06c == 0 ~ 0, bg06c == 1 ~ 1),
        other_care = case_when(bg06d == 0 ~ 0, bg06d == 1 ~ 1))
        
access_to_childcare_w1 <- access_to_childcare_w1 %>% 
  select(par_id, child_id, wave , par_gen, household_others, adult_others, 
         children_others, know_others, marital_status, recieve_childcare, 
         childcare_center, homebased_care, relative_care, other_care)

income_w1 <- overall_background%>% 
  mutate(par_id = as.character(parid),
         child_id = as.character(childid),
         wave = as.factor(wave),
         par_gen = case_when(
           pargen == 0 ~ 0,
           pargen == 1 ~ 1),
         household_income_numerical = as.integer(hhincome),
         household_income_categorical = case_when(
           bgz08a == 1 ~ "$5,000 or less",
           bgz08a == 2 ~ "$5,001 - $10,000",
           bgz08a == 3 ~ "$10,001 - $15,000",
           bgz08a == 4 ~ "$15,001 - $20,000",
           bgz08a == 5 ~ "$20,001 - $25,000",
           bgz08a == 6 ~ "$25,001 - $30,000",
           bgz08a == 7 ~ "$30,001 - $35,000",
           bgz08a == 8 ~ "$35,001 - $40,000",
           bgz08a == 9 ~ "$40,001 - $50,000",
           bgz08a == 10 ~ "$50,001 - $75,000",
           bgz08a == 11 ~ "$75,001 or more"),
         employment_status = case_when(
             employment == 1 ~ "Working for pay",
             employment == 2 ~ "Attending School",
             employment == 2 ~ "Unemployed",
             employment == 3 ~ "Stay at home parent",
             employment == 5 ~ "Multiple"),
         enough_money_clothes = case_when(
           bg09b == 1 ~ "Stongly disagree",
           bg09b == 2 ~ "Disagree",
           bg09b == 3 ~ "Neutral",
           bg09b == 4 ~ "Agree",
           bg09b == 5 ~ "Strongly agree"),
         enough_money_food = case_when(
           bg09c == 1 ~ "Stongly disagree",
           bg09c == 2 ~ "Disagree",
           bg09c == 3 ~ "Neutral",
           bg09c == 4 ~ "Agree",
           bg09c == 5 ~ "Strongly agree"),
         enough_money_medical_care = case_when(
           bg09d == 1 ~ "Stongly disagree",
           bg09d == 2 ~ "Disagree",
           bg09d == 3 ~ "Neutral",
           bg09d == 4 ~ "Agree",
           bg09d == 5 ~ "Strongly agree"),
         bill_difficulty = case_when(
           bg10 == 1 ~ "A great deal of difficulty",
           bg10 == 2 ~ "Quite a bit of difficulty",
           bg10 == 3 ~ "Some difficulty",
           bg10 == 4 ~ "A little difficulty",
           bg10 == 5 ~ "No difficulty")
         )

income_w1 <- income_w1 %>% 
  select(par_id, child_id, par_gen, wave, household_income_numerical, 
       household_income_categorical, employment_status, enough_money_clothes, 
       enough_money_food, enough_money_medical_care, bill_difficulty)

```

# Chandra's code

```{r}
glimpse(media_tech)

```

```{r}
media_tech_cleaned <- media_tech %>%
  transmute(child_id = as.character(childid),
         par_id = as.character(parid),
         q4a = as.factor(case_when(
           mt04a == 1 ~ "never_or_rarely",
           mt04a == 2 ~ "some_days_each_week",
           mt04a == 3 ~ "most_days_each_week",
           mt04a == 4 ~ "once_a_day",
           mt04a == 5 ~ "several_times_each_day")),
         q4b = as.factor(case_when(
           mt04b == 1 ~ "never_or_rarely",
           mt04b == 2 ~ "some_days_each_week",
           mt04b == 3 ~ "most_days_each_week",
           mt04b == 4 ~ "once_a_day",
           mt04b == 5 ~ "several_times_each_day")),
         q4c = as.factor(case_when(
           mt04c == 1 ~ "never_or_rarely",
           mt04c == 2 ~ "some_days_each_week",
           mt04c == 3 ~ "most_days_each_week",
           mt04c == 4 ~ "once_a_day",
           mt04c == 5 ~ "several_times_each_day")),
         q4d = as.factor(case_when(
           mt04d == 1 ~ "never_or_rarely",
           mt04d == 2 ~ "some_days_each_week",
           mt04d == 3 ~ "most_days_each_week",
           mt04d == 4 ~ "once_a_day",
           mt04d == 5 ~ "several_times_each_day")),
         q5a = as.factor(case_when(
           mt05a == 1 ~ "never_or_rarely",
           mt05a == 2 ~ "some_days_each_week",
           mt05a == 3 ~ "most_days_each_week",
           mt05a == 4 ~ "once_a_day",
           mt05a == 5 ~ "several_times_each_day")),
         q5b = as.factor(case_when(
           mt05b == 1 ~ "never_or_rarely",
           mt05b == 2 ~ "some_days_each_week",
           mt05b == 3 ~ "most_days_each_week",
           mt05b == 4 ~ "once_a_day",
           mt05b == 5 ~ "several_times_each_day")),
         q5c = as.factor(case_when(
           mt05c == 1 ~ "never_or_rarely",
           mt05c == 2 ~ "some_days_each_week",
           mt05c == 3 ~ "most_days_each_week",
           mt05c == 4 ~ "once_a_day",
           mt05c == 5 ~ "several_times_each_day")),
         q5d = as.factor(case_when(
           mt05d == 1 ~ "never_or_rarely",
           mt05d == 2 ~ "some_days_each_week",
           mt05d == 3 ~ "most_days_each_week",
           mt05d == 4 ~ "once_a_day",
           mt05d == 5 ~ "several_times_each_day")),
         q5e = as.factor(case_when(
           mt05e == 1 ~ "never_or_rarely",
           mt05e == 2 ~ "some_days_each_week",
           mt05e == 3 ~ "most_days_each_week",
           mt05e == 4 ~ "once_a_day",
           mt05e == 5 ~ "several_times_each_day")),
         q5f = as.factor(case_when(
           mt05f == 1 ~ "never_or_rarely",
           mt05f == 2 ~ "some_days_each_week",
           mt05f == 3 ~ "most_days_each_week",
           mt05f == 4 ~ "once_a_day",
           mt05f == 5 ~ "several_times_each_day")),
         q5g = as.factor(case_when(
           mt05g == 1 ~ "never_or_rarely",
           mt05g == 2 ~ "some_days_each_week",
           mt05g == 3 ~ "most_days_each_week",
           mt05g == 4 ~ "once_a_day",
           mt05g == 5 ~ "several_times_each_day")),
         q6a = as.logical(case_when(
           mt06a == 0 ~ 0,
           mt06a == 1 ~ 1)),
         q6b = as.logical(case_when(
           mt06b == 0 ~ 0,
           mt06b == 1 ~ 1)),
         q6c = as.logical(case_when(
           mt06c == 0 ~ 0,
           mt06c == 1 ~ 1)),
         q6d = as.logical(case_when(
           mt06d == 0 ~ 0,
           mt06d == 1 ~ 1)),
         q6e = as.logical(case_when(
           mt06e == 0 ~ 0,
           mt06e == 1 ~ 1)),
         q6f = as.logical(case_when(
           mt06f == 0 ~ 0,
           mt06f == 1 ~ 1)),
         q6g = as.logical(case_when(
           mt06g == 0 ~ 0,
           mt06g == 1 ~ 1)),
         q6h = as.logical(case_when(
           mt06h == 0 ~ 0,
           mt06h == 1 ~ 1)),
         q6i = as.logical(case_when(
           mt06i == 0 ~ 0,
           mt06i == 1 ~ 1)),
         q7a = as.factor(case_when(
           mt07a == 1 ~ "strongly_disagree",
           mt07a == 2 ~ "disagree",
           mt07a == 3 ~ "agree",
           mt07a == 4 ~ "strongly_agree")),
         q8 = as.logical(case_when(
           mt08 == 0 ~ 0,
           mt08 == 1 ~ 1)),
         q5hz = as.factor(case_when(
           mtz05hz == 1 ~ "never_or_rarely",
           mtz05hz == 2 ~ "some_days_each_week",
           mtz05hz == 3 ~ "most_days_each_week",
           mtz05hz == 4 ~ "once_a_day",
           mtz05hz == 5 ~ "several_times_each_day")),
         q5iz = as.factor(case_when(
           mtz05iz == 1 ~ "never_or_rarely",
           mtz05iz == 2 ~ "some_days_each_week",
           mtz05iz == 3 ~ "most_days_each_week",
           mtz05iz == 4 ~ "once_a_day",
           mtz05iz == 5 ~ "several_times_each_day")),
         q5jz = as.factor(case_when(
           mtz05jz == 1 ~ "never_or_rarely",
           mtz05jz == 2 ~ "some_days_each_week",
           mtz05jz == 3 ~ "most_days_each_week",
           mtz05jz == 4 ~ "once_a_day",
           mtz05jz == 5 ~ "several_times_each_day")),
         q5kz = as.factor(case_when(
           mtz05kz == 1 ~ "never_or_rarely",
           mtz05kz == 2 ~ "some_days_each_week",
           mtz05kz == 3 ~ "most_days_each_week",
           mtz05kz == 4 ~ "once_a_day",
           mtz05kz == 5 ~ "several_times_each_day")),
         q5lz = as.factor(case_when(
           mtz05lz == 1 ~ "never_or_rarely",
           mtz05lz == 2 ~ "some_days_each_week",
           mtz05lz == 3 ~ "most_days_each_week",
           mtz05lz == 4 ~ "once_a_day",
           mtz05lz == 5 ~ "several_times_each_day")),
         n_devices = MTndevices,
         tv_exposure = MTtvexposure,
         solo = MTsolomedia,
         passive = MTpassive,
         coop = MTcouse,
         mealtimes = MTmealtimes,
         behavior_management = MTdcbhv,
         positive_beliefs_media = MTbeliefs,
         educational_benefits = MTeduc,
         digital_babysitting = MTbabysit,
         daily_use = MTdailyuse
)
```

```{r}
# total na values per column
colSums(is.na(media_tech_cleaned))

# percentage na values per column
colMeans(is.na(media_tech_cleaned))
```

```{r}
# visualizing na values
library(visdat)
vis_miss(media_tech_cleaned)
```


```{r}
# correlation between average score data
library(ggcorrplot)
average_scores <- media_tech_cleaned %>% 
  select(!starts_with("q"), -child_id, -par_id)

correlation <- cor(average_scores, use = "complete.obs")

correlation
```


```{r}
# visualizing correlation
ggcorrplot(correlation,
           hc.order = TRUE,
           type = "lower",
           outline.color = "white")

```

```{r}
# wave 6 translations
model_w6 <- wave_6
for (i in 1:length(model_w6$bit08txt)) {
  value <- model_w6$bit08txt_e[i]
  if (value != "" && !(value %in% c("n/a", "N/A")) && is.na(as.numeric(value))) {
    model_w6$bit08txt[i] = model_w6$bit08txt_e[i]
  }
}

model_w6 <- model_w6
for (i in 1:length(model_w6$bit36txt)) {
  value <- model_w6$bit36txt_e[i]
  if (value != "" && !(value %in% c("n/a", "N/A")) && is.na(as.numeric(value))) {
    model_w6$bit36txt[i] = model_w6$bit36txt_e[i]
  }
}

model_w6 <- model_w6
for (i in 1:length(model_w6$bit37txt)) {
  value <- model_w6$bit37txt_e[i]
  if (value != "" && !(value %in% c("n/a", "N/A")) && is.na(as.numeric(value))) {
    model_w6$bit37txt[i] = model_w6$bit37txt_e[i]
  }
}

model_w6 <- model_w6
for (i in 1:length(model_w6$bit41txt)) {
  value <- model_w6$bit41txt_e[i]
  if (value != "" && !(value %in% c("n/a", "N/A")) && is.na(as.numeric(value))) {
    model_w6$bit41txt[i] = model_w6$bit41txt_e[i]
  }
}

model_w6 <- model_w6
for (i in 1:length(model_w6$bit42txt)) {
  value <- model_w6$bit42txt_e[i]
  if (value != "" && !(value %in% c("n/a", "N/A")) && is.na(as.numeric(value))) {
    model_w6$bit42txt[i] = model_w6$bit42txt_e[i]
  }
}

glimpse(model_w6)

```

```{r}
# wave 6 cleaning
model_w6 <- model_w6 %>% 
  transmute(child_id = as.character(childid),
          par_id = as.character(parid),
          wave = as.factor(wave),
          pargen = as.factor(pargen),
          site = as.factor(site),
          bit01 = as.factor(case_when(
            bit01 == 0 ~ "Not true/Rarely",
            bit01 == 1 ~ "Somewhat true/Sometimes",
            bit01 == 2 ~ "Very true/Often"
          )),
          bit02 = as.factor(case_when(
						bit02 == 0 ~ "Not true/Rarely",
						bit02 == 1 ~ "Somewhat true/Sometimes",
						bit02 == 2 ~ "Very true/Often")),
          bit03 = as.factor(case_when(
						bit03 == 0 ~ "Not true/Rarely",
						bit03 == 1 ~ "Somewhat true/Sometimes",
						bit03 == 2 ~ "Very true/Often")),
          bit04 = as.factor(case_when(
						bit04 == 0 ~ "Not true/Rarely",
						bit04 == 1 ~ "Somewhat true/Sometimes",
						bit04 == 2 ~ "Very true/Often")),
          bit05 = as.factor(case_when(
						bit05 == 0 ~ "Not true/Rarely",
						bit05 == 1 ~ "Somewhat true/Sometimes",
						bit05 == 2 ~ "Very true/Often")),
          bit06 = as.factor(case_when(
						bit06 == 0 ~ "Not true/Rarely",
						bit06 == 1 ~ "Somewhat true/Sometimes",
						bit06 == 2 ~ "Very true/Often")),
          bit07 = as.factor(case_when(
						bit07 == 0 ~ "Not true/Rarely",
						bit07 == 1 ~ "Somewhat true/Sometimes",
						bit07 == 2 ~ "Very true/Often")),
          bit08 = as.factor(case_when(
						bit08 == 0 ~ "Not true/Rarely",
						bit08 == 1 ~ "Somewhat true/Sometimes",
						bit08 == 2 ~ "Very true/Often")),
          bit08txt = as.character(bit08txt),
          bit09 = as.factor(case_when(
						bit09 == 0 ~ "Not true/Rarely",
						bit09 == 1 ~ "Somewhat true/Sometimes",
						bit09 == 2 ~ "Very true/Often")),
          bit10 = as.factor(case_when(
						bit10 == 0 ~ "Not true/Rarely",
						bit10 == 1 ~ "Somewhat true/Sometimes",
						bit10 == 2 ~ "Very true/Often")),
          bit11 = as.factor(case_when(
						bit11 == 0 ~ "Not true/Rarely",
						bit11 == 1 ~ "Somewhat true/Sometimes",
						bit11 == 2 ~ "Very true/Often")),
          bit12 = as.factor(case_when(
						bit12 == 0 ~ "Not true/Rarely",
						bit12 == 1 ~ "Somewhat true/Sometimes",
						bit12 == 2 ~ "Very true/Often")),
          bit13 = as.factor(case_when(
						bit13 == 0 ~ "Not true/Rarely",
						bit13 == 1 ~ "Somewhat true/Sometimes",
						bit13 == 2 ~ "Very true/Often")),
          bit14 = as.factor(case_when(
						bit14 == 0 ~ "Not true/Rarely",
						bit14 == 1 ~ "Somewhat true/Sometimes",
						bit14 == 2 ~ "Very true/Often")),
          bit15 = as.factor(case_when(
						bit15 == 0 ~ "Not true/Rarely",
						bit15 == 1 ~ "Somewhat true/Sometimes",
						bit15 == 2 ~ "Very true/Often")),
          bit16 = as.factor(case_when(
						bit16 == 0 ~ "Not true/Rarely",
						bit16 == 1 ~ "Somewhat true/Sometimes",
						bit16 == 2 ~ "Very true/Often")),
          bit17 = as.factor(case_when(
						bit17 == 0 ~ "Not true/Rarely",
						bit17 == 1 ~ "Somewhat true/Sometimes",
						bit17 == 2 ~ "Very true/Often")),
          bit18 = as.factor(case_when(
						bit18 == 0 ~ "Not true/Rarely",
						bit18 == 1 ~ "Somewhat true/Sometimes",
						bit18 == 2 ~ "Very true/Often")),
          bit19 = as.factor(case_when(
						bit19 == 0 ~ "Not true/Rarely",
						bit19 == 1 ~ "Somewhat true/Sometimes",
						bit19 == 2 ~ "Very true/Often")),
          bit20 = as.factor(case_when(
						bit20 == 0 ~ "Not true/Rarely",
						bit20 == 1 ~ "Somewhat true/Sometimes",
						bit20 == 2 ~ "Very true/Often")),
          bit21 = as.factor(case_when(
						bit21 == 0 ~ "Not true/Rarely",
						bit21 == 1 ~ "Somewhat true/Sometimes",
						bit21 == 2 ~ "Very true/Often")),
          bit22 = as.factor(case_when(
						bit22 == 0 ~ "Not true/Rarely",
						bit22 == 1 ~ "Somewhat true/Sometimes",
						bit22 == 2 ~ "Very true/Often")),
          bit23 = as.factor(case_when(
						bit23 == 0 ~ "Not true/Rarely",
						bit23 == 1 ~ "Somewhat true/Sometimes",
						bit23 == 2 ~ "Very true/Often")),
          bit24 = as.factor(case_when(
						bit24 == 0 ~ "Not true/Rarely",
						bit24 == 1 ~ "Somewhat true/Sometimes",
						bit24 == 2 ~ "Very true/Often")),
          bit25 = as.factor(case_when(
						bit25 == 0 ~ "Not true/Rarely",
						bit25 == 1 ~ "Somewhat true/Sometimes",
						bit25 == 2 ~ "Very true/Often")),
          bit26 = as.factor(case_when(
						bit26 == 0 ~ "Not true/Rarely",
						bit26 == 1 ~ "Somewhat true/Sometimes",
						bit26 == 2 ~ "Very true/Often")),
          bit27 = as.factor(case_when(
						bit27 == 0 ~ "Not true/Rarely",
						bit27 == 1 ~ "Somewhat true/Sometimes",
						bit27 == 2 ~ "Very true/Often")),
          bit28 = as.factor(case_when(
						bit28 == 0 ~ "Not true/Rarely",
						bit28 == 1 ~ "Somewhat true/Sometimes",
						bit28 == 2 ~ "Very true/Often")),
          bit29 = as.factor(case_when(
						bit29 == 0 ~ "Not true/Rarely",
						bit29 == 1 ~ "Somewhat true/Sometimes",
						bit29 == 2 ~ "Very true/Often")),
          bit30 = as.factor(case_when(
						bit30 == 0 ~ "Not true/Rarely",
						bit30 == 1 ~ "Somewhat true/Sometimes",
						bit30 == 2 ~ "Very true/Often")),
          bit31 = as.factor(case_when(
						bit31 == 0 ~ "Not true/Rarely",
						bit31 == 1 ~ "Somewhat true/Sometimes",
						bit31 == 2 ~ "Very true/Often")),
          bit32 = as.factor(case_when(
						bit32 == 0 ~ "Not true/Rarely",
						bit32 == 1 ~ "Somewhat true/Sometimes",
						bit32 == 2 ~ "Very true/Often")),
          bit33 = as.factor(case_when(
						bit33 == 0 ~ "Not true/Rarely",
						bit33 == 1 ~ "Somewhat true/Sometimes",
						bit33 == 2 ~ "Very true/Often")),
          bit34 = as.factor(case_when(
						bit34 == 0 ~ "Not true/Rarely",
						bit34 == 1 ~ "Somewhat true/Sometimes",
						bit34 == 2 ~ "Very true/Often")),
          bit35 = as.factor(case_when(
						bit35 == 0 ~ "Not true/Rarely",
						bit35 == 1 ~ "Somewhat true/Sometimes",
						bit35 == 2 ~ "Very true/Often")),
          bit36 = as.factor(case_when(
						bit36 == 0 ~ "Not true/Rarely",
						bit36 == 1 ~ "Somewhat true/Sometimes",
						bit36 == 2 ~ "Very true/Often")),
          bit36txt = as.character(bit36txt),
          bit37 = as.factor(case_when(
						bit37 == 0 ~ "Not true/Rarely",
						bit37 == 1 ~ "Somewhat true/Sometimes",
						bit37 == 2 ~ "Very true/Often")),
          bit37txt = as.character(bit37txt),
          bit38 = as.factor(case_when(
						bit38 == 0 ~ "Not true/Rarely",
						bit38 == 1 ~ "Somewhat true/Sometimes",
						bit38 == 2 ~ "Very true/Often")),
          bit39 = as.factor(case_when(
						bit39 == 0 ~ "Not true/Rarely",
						bit39 == 1 ~ "Somewhat true/Sometimes",
						bit39 == 2 ~ "Very true/Often")),
          bit40 = as.factor(case_when(
						bit40 == 0 ~ "Not true/Rarely",
						bit40 == 1 ~ "Somewhat true/Sometimes",
						bit40 == 2 ~ "Very true/Often")),
          bit41 = as.factor(case_when(
						bit41 == 0 ~ "Not true/Rarely",
						bit41 == 1 ~ "Somewhat true/Sometimes",
						bit41 == 2 ~ "Very true/Often")),
          bit41txt = as.character(bit41txt),
          bit42 = as.factor(case_when(
						bit42 == 0 ~ "Not true/Rarely",
						bit42 == 1 ~ "Somewhat true/Sometimes",
						bit42 == 2 ~ "Very true/Often")),
          bit42txt = as.character(bit42txt),
          bit43a = as.factor(case_when(
						bit43a == 1 ~ "Not worried at all",
						bit43a == 2 ~ "A little worried",
						bit43a == 3 ~ "Worried",
						bit43a == 4 ~ "Very worried")),
          bit43b = as.factor(case_when(
						bit43b == 1 ~ "Not worried at all",
						bit43b == 2 ~ "A little worried",
						bit43b == 3 ~ "Worried",
						bit43b == 4 ~ "Very worried")),
          BITcompnic = as.integer(BITcompnic),
          BITcompts = as.integer(BITcompts),
          BITcompavg = as.double(BITcompavg),
          BITprobnic = as.integer(BITprobnic),
          BITprobts = as.integer(BITprobts),
          BITprobavg = as.double(BITprobavg),
          BITcomp_cut = as.integer(BITcomp_cut),
          BITprob_cut = as.integer(BITprob_cut),)

glimpse(model_w6)
```



# Deborah's code
```{r}
overall_background$bg14 %>% 
  glimpse()
```

```{r}
# parent education table
parent_education <- overall_background %>% 
  select(parid, childid, wave, pargen, bg07f, bg14, bg16, bgz16, bg17a, bg17b) %>% 
  glimpse()

#problem, converting bg14 & bg17a into logical turns all obs into NA instead of 0 & 1
parent_education <- parent_education %>%
  zap_labels(bg17a) %>% # gets rid of default datatype
  zap_labels(bg14) %>% # gets rid of default datatype
    mutate(par_id = as.character(parid),
         child_id  = as.character(childid),
         wave = as.factor(wave),
         father = as.logical(pargen),
         degree_cert_in_prog = as.factor(
           case_when(
             bg07f == 0 ~ "None",
             bg07f == 1 ~ "GED",
             bg07f == 2 ~ "AA",
             bg07f == 3 ~ "Technical Cert",
             bg07f == 4 ~ "BA/BS",
             bg07f == 5 ~ "Other"
             )),
         #bg14 = case_when(
         #  bg14 == 0 ~ "no",
         #  bg14 == 1 ~ "yes"),
         parenting_class_taken = as.logical(bg14),
         highest_degree_completed = as.factor(
           case_when(
             bg16 == 1 ~ "some elementary",
             bg16 == 2 ~ "completed elementary",
             bg16 == 3 ~ "some middle school",
             bg16 == 4 ~ "completed middle school",
             bg16 == 5 ~ "some highschool",
             bg16 == 6 ~ "completed highschool",
             bg16 == 7 ~ "some college",
             bg16 == 8 ~ "2 yr cert or degree",
             bg16 == 9 ~ "4 yr cert or degree",
             bg16 == 10 ~ "Other",
             )),
         highest_degree_completed = fct_relevel(
           highest_degree_completed, 
           "some elementary", 
           "completed elementary", 
           "some middle school", 
           "completed middle school",
           "some highschool",
           "completed highschool",
           "some college",
           "2 yr cert or degree",
           "4 yr cert or degree",
           "Other"
           ),
         years_school_complete = as.numeric(bgz16),
         #bg17a = case_when(
         #  bg17a == 0 ~ "no",
         #  bg17a == 1 ~ "yes"),
         #us_education = as.factor(bg17a),
         us_education = as.logical(bg17a),
         education_location = as.character(bg17b),
         education_location = case_when(
           education_location == -777 ~ "planned skip",
           education_location == -111 ~ "drop",
           education_location == -222 ~ "different version",
           education_location == -333 ~ "other parent",
           education_location == -444 ~ "unable",
           education_location == -555 ~ "unsure",
           education_location == -666 ~ "refused",
           education_location == -888 ~ "error",
           education_location == -999 ~ "missing tool")) %>% 
  select(par_id,
         child_id, 
         wave, 
         father, 
         degree_cert_in_prog, 
         parenting_class_taken,
         highest_degree_completed,
         years_school_complete,
         us_education,
         education_location) %>% 
  glimpse()
```
```{r}
parent_education$highest_degree_completed %>% 
  fct_relevel()
```

```{r}
#Creating parent English Fluency Table

parent_english_fluency <- overall_background %>% 
  select(parid, childid, wave, pargen, bg25r, bg26r, bg27r, bg28r, englishlanguage) %>%  
  glimpse()
```

```{r}
#cleaning up parent_fluency table
parent_english_fluency <- overall_background %>% 
  zap_labels() %>% 
  mutate(par_id = as.character(parid),
         child_id  = as.character(childid),
         wave = as.factor(wave),
         father = as.logical(pargen),
         speaking_english = as.factor(
           case_when(
             bg25r == 0 ~ "not well at all",
             bg25r == 1 ~ "not very well",
             bg25r == 2 ~ "pretty well",
             bg25r == 3 ~ "very well"
             )),
         reading_english = as.factor(
           case_when(
             bg26r == 0 ~ "not well at all",
             bg26r == 1 ~ "not very well",
             bg26r == 2 ~ "pretty well",
             bg26r == 3 ~ "very well"
             )),
         writing_english = as.factor(
           case_when(
             bg27r == 0 ~ "not well at all",
             bg27r == 1 ~ "not very well",
             bg27r == 2 ~ "pretty well",
             bg27r == 3 ~ "very well"
             )),
         understanding_english = as.factor(
           case_when(
             bg28r == 0 ~ "not well at all",
             bg28r == 1 ~ "not very well",
             bg28r == 2 ~ "pretty well",
             bg28r == 3 ~ "very well"
             )),
         english_level = as.integer(englishlanguage)
         ) %>% 
  select(par_id,
         child_id,
         wave,
         father,
         speaking_english,
         reading_english,
         writing_english,
         understanding_english,
         english_level
         ) %>% 
  glimpse()

```

# James' code

## clean wave_2

```{r}
wave_2 <- wave_2 %>% 
  select(-version_31_BIT_w2)
```
```{r}
model_w2 <- wave_2 %>% 
  mutate(child_id = as.character(childid),
          par_id = as.character(parid),
          wave = as.factor(wave),
          pargen = as.factor(pargen),
          svdt_31_BIT_w2 = as.factor(svdt_31_BIT_w2),
          language_31_BIT_w2 = as.factor(language_31_BIT_w2),
          site = as.factor(site),
          bit01 = as.factor(case_when(
            bit01 == 0 ~ "Not true/Rarely",
            bit01 == 1 ~ "Somewhat true/Sometimes",
            bit01 == 2 ~ "Very true/Often"
          )),
          bit02 = as.factor(case_when(
						bit02 == 0 ~ "Not true/Rarely",
						bit02 == 1 ~ "Somewhat true/Sometimes",
						bit02 == 2 ~ "Very true/Often")),
          bit03 = as.factor(case_when(
						bit03 == 0 ~ "Not true/Rarely",
						bit03 == 1 ~ "Somewhat true/Sometimes",
						bit03 == 2 ~ "Very true/Often")),
          bit04 = as.factor(case_when(
						bit04 == 0 ~ "Not true/Rarely",
						bit04 == 1 ~ "Somewhat true/Sometimes",
						bit04 == 2 ~ "Very true/Often")),
          bit05 = as.factor(case_when(
						bit05 == 0 ~ "Not true/Rarely",
						bit05 == 1 ~ "Somewhat true/Sometimes",
						bit05 == 2 ~ "Very true/Often")),
          bit06 = as.factor(case_when(
						bit06 == 0 ~ "Not true/Rarely",
						bit06 == 1 ~ "Somewhat true/Sometimes",
						bit06 == 2 ~ "Very true/Often")),
          bit07 = as.factor(case_when(
						bit07 == 0 ~ "Not true/Rarely",
						bit07 == 1 ~ "Somewhat true/Sometimes",
						bit07 == 2 ~ "Very true/Often")),
          bit08 = as.factor(case_when(
						bit08 == 0 ~ "Not true/Rarely",
						bit08 == 1 ~ "Somewhat true/Sometimes",
						bit08 == 2 ~ "Very true/Often")),
          bit08txt = as.character(bit08txt),
          bit08txt_r = as.character(bit08txt_r),
          bit08txt_e = as.character(bit08txt_e),
          bit09 = as.factor(case_when(
						bit09 == 0 ~ "Not true/Rarely",
						bit09 == 1 ~ "Somewhat true/Sometimes",
						bit09 == 2 ~ "Very true/Often")),
          bit10 = as.factor(case_when(
						bit10 == 0 ~ "Not true/Rarely",
						bit10 == 1 ~ "Somewhat true/Sometimes",
						bit10 == 2 ~ "Very true/Often")),
          bit11 = as.factor(case_when(
						bit11 == 0 ~ "Not true/Rarely",
						bit11 == 1 ~ "Somewhat true/Sometimes",
						bit11 == 2 ~ "Very true/Often")),
          bit12 = as.factor(case_when(
						bit12 == 0 ~ "Not true/Rarely",
						bit12 == 1 ~ "Somewhat true/Sometimes",
						bit12 == 2 ~ "Very true/Often")),
          bit13 = as.factor(case_when(
						bit13 == 0 ~ "Not true/Rarely",
						bit13 == 1 ~ "Somewhat true/Sometimes",
						bit13 == 2 ~ "Very true/Often")),
          bit14 = as.factor(case_when(
						bit14 == 0 ~ "Not true/Rarely",
						bit14 == 1 ~ "Somewhat true/Sometimes",
						bit14 == 2 ~ "Very true/Often")),
          bit15 = as.factor(case_when(
						bit15 == 0 ~ "Not true/Rarely",
						bit15 == 1 ~ "Somewhat true/Sometimes",
						bit15 == 2 ~ "Very true/Often")),
          bit16 = as.factor(case_when(
						bit16 == 0 ~ "Not true/Rarely",
						bit16 == 1 ~ "Somewhat true/Sometimes",
						bit16 == 2 ~ "Very true/Often")),
          bit17 = as.factor(case_when(
						bit17 == 0 ~ "Not true/Rarely",
						bit17 == 1 ~ "Somewhat true/Sometimes",
						bit17 == 2 ~ "Very true/Often")),
          bit18 = as.factor(case_when(
						bit18 == 0 ~ "Not true/Rarely",
						bit18 == 1 ~ "Somewhat true/Sometimes",
						bit18 == 2 ~ "Very true/Often")),
          bit19 = as.factor(case_when(
						bit19 == 0 ~ "Not true/Rarely",
						bit19 == 1 ~ "Somewhat true/Sometimes",
						bit19 == 2 ~ "Very true/Often")),
          bit20 = as.factor(case_when(
						bit20 == 0 ~ "Not true/Rarely",
						bit20 == 1 ~ "Somewhat true/Sometimes",
						bit20 == 2 ~ "Very true/Often")),
          bit21 = as.factor(case_when(
						bit21 == 0 ~ "Not true/Rarely",
						bit21 == 1 ~ "Somewhat true/Sometimes",
						bit21 == 2 ~ "Very true/Often")),
          bit22 = as.factor(case_when(
						bit22 == 0 ~ "Not true/Rarely",
						bit22 == 1 ~ "Somewhat true/Sometimes",
						bit22 == 2 ~ "Very true/Often")),
          bit23 = as.factor(case_when(
						bit23 == 0 ~ "Not true/Rarely",
						bit23 == 1 ~ "Somewhat true/Sometimes",
						bit23 == 2 ~ "Very true/Often")),
          bit24 = as.factor(case_when(
						bit24 == 0 ~ "Not true/Rarely",
						bit24 == 1 ~ "Somewhat true/Sometimes",
						bit24 == 2 ~ "Very true/Often")),
          bit25 = as.factor(case_when(
						bit25 == 0 ~ "Not true/Rarely",
						bit25 == 1 ~ "Somewhat true/Sometimes",
						bit25 == 2 ~ "Very true/Often")),
          bit26 = as.factor(case_when(
						bit26 == 0 ~ "Not true/Rarely",
						bit26 == 1 ~ "Somewhat true/Sometimes",
						bit26 == 2 ~ "Very true/Often")),
          bit27 = as.factor(case_when(
						bit27 == 0 ~ "Not true/Rarely",
						bit27 == 1 ~ "Somewhat true/Sometimes",
						bit27 == 2 ~ "Very true/Often")),
          bit28 = as.factor(case_when(
						bit28 == 0 ~ "Not true/Rarely",
						bit28 == 1 ~ "Somewhat true/Sometimes",
						bit28 == 2 ~ "Very true/Often")),
          bit29 = as.factor(case_when(
						bit29 == 0 ~ "Not true/Rarely",
						bit29 == 1 ~ "Somewhat true/Sometimes",
						bit29 == 2 ~ "Very true/Often")),
          bit30 = as.factor(case_when(
						bit30 == 0 ~ "Not true/Rarely",
						bit30 == 1 ~ "Somewhat true/Sometimes",
						bit30 == 2 ~ "Very true/Often")),
          bit31 = as.factor(case_when(
						bit31 == 0 ~ "Not true/Rarely",
						bit31 == 1 ~ "Somewhat true/Sometimes",
						bit31 == 2 ~ "Very true/Often")),
          bit32 = as.factor(case_when(
						bit32 == 0 ~ "Not true/Rarely",
						bit32 == 1 ~ "Somewhat true/Sometimes",
						bit32 == 2 ~ "Very true/Often")),
          bit33 = as.factor(case_when(
						bit33 == 0 ~ "Not true/Rarely",
						bit33 == 1 ~ "Somewhat true/Sometimes",
						bit33 == 2 ~ "Very true/Often")),
          bit34 = as.factor(case_when(
						bit34 == 0 ~ "Not true/Rarely",
						bit34 == 1 ~ "Somewhat true/Sometimes",
						bit34 == 2 ~ "Very true/Often")),
          bit35 = as.factor(case_when(
						bit35 == 0 ~ "Not true/Rarely",
						bit35 == 1 ~ "Somewhat true/Sometimes",
						bit35 == 2 ~ "Very true/Often")),
          bit36 = as.factor(case_when(
						bit36 == 0 ~ "Not true/Rarely",
						bit36 == 1 ~ "Somewhat true/Sometimes",
						bit36 == 2 ~ "Very true/Often")),
          bit36txt = as.character(bit36txt),
          bit36txt_r = as.character(bit36txt_r),
          bit36txt_e = as.character(bit36txt_e),
          bit37 = as.factor(case_when(
						bit37 == 0 ~ "Not true/Rarely",
						bit37 == 1 ~ "Somewhat true/Sometimes",
						bit37 == 2 ~ "Very true/Often")),
          bit37txt = as.character(bit37txt),
          bit37txt_r = as.character(bit37txt_r),
          bit37txt_e = as.character(bit37txt_e),
          bit38 = as.factor(case_when(
						bit38 == 0 ~ "Not true/Rarely",
						bit38 == 1 ~ "Somewhat true/Sometimes",
						bit38 == 2 ~ "Very true/Often")),
          bit39 = as.factor(case_when(
						bit39 == 0 ~ "Not true/Rarely",
						bit39 == 1 ~ "Somewhat true/Sometimes",
						bit39 == 2 ~ "Very true/Often")),
          bit40 = as.factor(case_when(
						bit40 == 0 ~ "Not true/Rarely",
						bit40 == 1 ~ "Somewhat true/Sometimes",
						bit40 == 2 ~ "Very true/Often")),
          bit41 = as.factor(case_when(
						bit41 == 0 ~ "Not true/Rarely",
						bit41 == 1 ~ "Somewhat true/Sometimes",
						bit41 == 2 ~ "Very true/Often")),
          bit41txt = as.character(bit41txt),
          bit41txt_r = as.character(bit41txt_r),
          bit41txt_e = as.character(bit41txt_e),
          bit42 = as.factor(case_when(
						bit42 == 0 ~ "Not true/Rarely",
						bit42 == 1 ~ "Somewhat true/Sometimes",
						bit42 == 2 ~ "Very true/Often")),
          bit42txt = as.character(bit42txt),
          bit42txt_r = as.character(bit42txt_r),
          bit42txt_e = as.character(bit42txt_e),
          bit43a = as.factor(case_when(
						bit43a == 1 ~ "Not worried at all",
						bit43a == 2 ~ "A little worried",
						bit43a == 3 ~ "Worried",
						bit43a == 4 ~ "Very worried")),
          bit43b = as.factor(case_when(
						bit43b == 1 ~ "Not worried at all",
						bit43b == 2 ~ "A little worried",
						bit43b == 3 ~ "Worried",
						bit43b == 4 ~ "Very worried")),
          BITcompnic = as.integer(BITcompnic),
          BITcompts = as.integer(BITcompts),
          BITcompavg = as.double(BITcompavg),
          BITprobnic = as.integer(BITprobnic),
          BITprobts = as.integer(BITprobts),
          BITprobavg = as.double(BITprobavg),
          BITcomp_cut = as.integer(BITcomp_cut),
          BITprob_cut = as.integer(BITprob_cut))
```

### Removed non-english text responses - Chandra

```{r}
# wave 2 translations
model_w2 <- model_w2
for (i in 1:length(model_w2$bit08txt)) {
  value <- model_w2$bit08txt_e[i]
  if (value != "" && !(value %in% c("n/a", "N/A")) && is.na(as.numeric(value))) {
    model_w2$bit08txt[i] = model_w2$bit08txt_e[i]
  }
}

model_w2 <- model_w2
for (i in 1:length(model_w2$bit36txt)) {
  value <- model_w2$bit36txt_e[i]
  if (value != "" && !(value %in% c("n/a", "N/A")) && is.na(as.numeric(value))) {
    model_w2$bit36txt[i] = model_w2$bit36txt_e[i]
  }
}

model_w2 <- model_w2
for (i in 1:length(model_w2$bit37txt)) {
  value <- model_w2$bit37txt_e[i]
  if (value != "" && !(value %in% c("n/a", "N/A")) && is.na(as.numeric(value))) {
    model_w2$bit37txt[i] = model_w2$bit37txt_e[i]
  }
}

model_w2 <- model_w2
for (i in 1:length(model_w2$bit41txt)) {
  value <- model_w2$bit41txt_e[i]
  if (value != "" && !(value %in% c("n/a", "N/A")) && is.na(as.numeric(value))) {
    model_w2$bit41txt[i] = model_w2$bit41txt_e[i]
  }
}

model_w2 <- model_w2
for (i in 1:length(model_w2$bit42txt)) {
  value <- model_w2$bit42txt_e[i]
  if (value != "" && !(value %in% c("n/a", "N/A")) && is.na(as.numeric(value))) {
    model_w2$bit42txt[i] = model_w2$bit42txt_e[i]
  }
}

glimpse(model_w2)

```

remove redundant variables

```{r}
model_w2 <- model_w2 %>% 
  select(-c(bit08txt_r,bit08txt_e,bit36txt_r, bit36txt_e,bit37txt_r,bit37txt_e,bit41txt_r,bit41txt_e,bit42txt_e,bit42txt_r, childid, parid))
```


## clean data w1

```{r}
scores_w1 <- clean_names(scores_w1)
glimpse(scores_w1)
```
```{r}
scores_w1 <-  scores_w1 %>% 
  mutate(child_id = as.character(childid),
         par_id = as.character(parid),
         father = pargen == 1,
        language_26_PLS_w1 = as.factor(case_when(
          language_26_pls_w1 == 0 ~ "english",
          language_26_pls_w1 == 1 ~ "spanish"
        )),
        site = as.factor(case_when(
          site == 1 ~ "UMD",
          site == 2 ~ "UCI"
        )))
```

```{r}
model_score <- scores_w1 %>%
  select(child_id, par_id, father, language = language_26_PLS_w1, auditory_comprehension_score = plsacss, expressive_communication_score = plsecss, total_score = plsss)
```


# Nick's code

```{r}

parent_demographic <- demographic_background %>%
  mutate(child_id = as.character(childid),
         par_id = as.character(parid),
         language = case_when(
           language == 1 ~1, 
           language == 0 ~ 0),
         span_lang_form = as.logical(language),
         pargen = case_when(
           pargen == 0 ~ 0,
           pargen == 1 ~ 1),
         father = as.logical(pargen),
         data_site = as.character(site),
         par_ethnicity= as.character(dem04),
         par_ethnicity = case_when(
            dem04 == 1 ~ "White",
            dem04 == 2 ~ "African American",
            dem04 == 4 ~ "Asian/Asian American",
            dem04 == 5 ~ "Middle Eastern",
            dem04 == 7 ~ "Native Haiwaiian/Pacific Islander",
            dem04 == 8 ~ "Hispanic/Latino",
            dem04 == 9 ~ "Other",
            dem04 == 10 ~ "multiracial"),
         dem05 = case_when(
           dem05 == 0 ~ 0,
           dem05 == 1 ~ 1),
         par_us_born = as.logical(dem05),
         par_language = as.character(dem06),
         par_language = case_when(
           dem06 == 1 ~ "English",
           dem06 == 2 ~ "Spanish",
           dem06 == 3 ~ "English/Spanish",
           dem06 == 5 ~ "English/Other",
           dem06 == 6 ~ "multilingual"),
         dem08 = case_when(
           dem08 == 0 ~ 0,
           dem08 == 1 ~1),
         chi_girl = as.logical(dem08),
         birth_time = case_when(
           dem10 == 1 ~ "on time",
           dem10 == 2 ~ "early",
           dem10 == 3 ~ "late"),
         dem11 = case_when(dem11 == 0 ~ 0, dem11 == 1 ~1),
         planned_preg = as.logical(dem11),
         dem16 = case_when(
           dem16 == 1 ~ "White",
           dem16 == 2 ~ "Black/AA",
           dem16 == 3 ~ "Asian",
           dem16 == 8 ~ "Hispanic/Latino",
           dem16 == 9 ~ "Other",
           dem16 == 10 ~ "Multiracial"),
         chi_ethnicity = as.character(dem16),
         dem17 = case_when(
           dem17 == 1 ~ "English",
           dem17 == 2 ~ "Spanish",
           dem17 == 3 ~ "English/Spanish",
           dem17 == 4 ~ "Vietnamese",
           dem17 == 5 ~ "English/Other", 
           dem17 == 6 ~ "Multilingual",
           dem17 == 7 ~ "Other"),
         chi_par_lang = as.character(dem17),
         dem19 = case_when(
           dem19 == 1 ~ "English",
           dem19 == 2 ~ "Spanish",
           dem19 == 3 ~ "English/Spanish",
           dem19 == 4 ~ "Vietnamese",
           dem19 == 5 ~ "English/Other",
           dem19 == 6 ~ "Multilingual",
           dem19 == 7 ~ "Other"),
         relatives_lang = as.character(dem19) ) %>% 
  select(child_id, par_id, span_lang_form, father,data_site, 
         par_ethnicity,par_us_born, par_language, chi_girl, 
         birth_time, planned_preg, chi_ethnicity, chi_par_lang, 
         relatives_lang )
  

```

```{r}
  
ggplot(data = parent_demographic, aes( 
  x= par_ethnicity)) +
geom_bar()
parent_demographic %>% 
  ggplot(aes(x = chi_par_lang)) + 
  geom_bar()
#most parents speak either english or spanish to their children
parent_demographic %>% 
  ggplot(aes(x = par_language)) + 
  geom_bar()
#majority parents speak english/spanish
parent_demographic %>% 
  ggplot(aes(x = par_us_born)) + 
  geom_bar()
#Slightly more than half of the parents were born outside of the U.S.
```

```{r}
valuable_dataset = inner_join(media_tech_cleaned, parent_education, by=c("child_id", "par_id")) 
valuable_dataset= inner_join(valuable_dataset, parent_demographic, by=c("child_id", "par_id"))  
valuable_dataset  = inner_join(valuable_dataset, model_score, by=c("child_id", "par_id"))
valuable_dataset = inner_join(valuable_dataset, public_assistance_w1, by=c("child_id", "par_id"))
valuable_dataset = inner_join(valuable_dataset, access_to_childcare_w1, by=c("child_id", "par_id")) 
valuable_dataset = inner_join(valuable_dataset, income_w1, by=c("child_id", "par_id")) 


```

```{r}
  ggplot(data= valuable_dataset, aes(x=par_ethnicity, 
             y= total_score,
             fill = par_ethnicity)) +
  geom_boxplot(alpha = 0.3) +
  labs(x= "Parent Ethnicity",
       y= "Total Score") + 
  theme(panel.grid.major = element_blank(), 
                 panel.grid.minor = element_blank(),
        panel.background = element_blank(), 
        axis.line = element_line(colour = "black"),
        axis.text.x=element_blank(),
        legend.title = element_text(colour = "steelblue", face = "bold.italic",)) +
  ggtitle("Spread of ACS")
  
valuable_dataset %>% 
  ggplot(aes(x = par_us_born,
             y = auditory_comprehension_score)) + 
  geom_boxplot() +
  labs(x = "Parent Born in U.S.",
       y= "Auditory Comprehension Score") +
  theme_minimal()

valuable_dataset %>% 
  ggplot(aes(x = chi_girl,
             y = total_score)) + 
  geom_boxplot() +
  labs(x = "Was The form in spanish?",
       y= "Auditory Comprehension Score") +
  theme_minimal()

valuable_dataset %>% 
  mutate(years_school_complete = as.character(years_school_complete)) %>% 
  ggplot(aes(x = years_school_complete,
             y = total_score)) + 
  geom_boxplot()
   
valuable_dataset %>% 
  mutate(daily_use = as.numeric(daily_use)) %>% 
  ggplot(aes(x = solo, 
             y = daily_use)) +
  geom_point()

valuable_dataset %>%
  ggplot(aes(x = total_score,
             y= daily_use)) +
  geom_point()

valuable_dataset %>% 
  ggplot(aes(x = household_income_numerical,
             y = daily_use)) +
  geom_point()

valuable_dataset %>% 
  ggplot(aes(x = positive_beliefs_media,
             y = total_score)) + 
  geom_point()

valuable_dataset %>% 
  ggplot(aes(x = passive,
             y = daily_use)) + 
  geom_point()

valuable_dataset %>% 
  ggplot(aes(x = q7a,
             y = daily_use)) +
  geom_boxplot()

valuable_dataset %>% 
  ggplot(aes(x = tv_exposure,
             y = daily_use)) +
  geom_point()

valuable_dataset %>% 
  ggplot(aes(x = coop,
             y = total_score)) +
  geom_point()

valuable_dataset %>% 
  ggplot(aes(x = coop,
             y = daily_use)) +
  geom_point()

valuable_dataset %>% 
  ggplot(aes(x = n_devices,
             y = positive_beliefs_media)) + 
  geom_point()

#q8: do you limit how much time the children use 
valuable_dataset %>% 
  ggplot(aes(x =  positive_beliefs_media,
             y = highest_degree_completed,
             fill = parenting_class_taken)) +
  geom_boxplot() + 


valuable_dataset %>% 
  ggplot(aes(y = household_income_numerical,
             x = highest_degree_completed,
             fill = highest_degree_completed)) +
  geom_boxplot()

valuable_dataset %>% 
  ggplot(aes(x = positive_beliefs_media,
             y = daily_use,
             fill = positive_beliefs_media)) +
  geom_point()

```


# James'

```{r}
model_score_demographic = full_join(model_score, parent_demographic, by=c("child_id", "par_id"))
```

```{r}
model_score_demographic %>% 
  glimpse()
```

```{r}
model_score_demographic %>% 
  ggplot(aes(x = chi_ethnicity,
             y = total_score))+
  geom_col()
```


---

# Deborah's Preliminary EDA
Just based off my tables is there a relationship between English proficiency and education?
* parent_english_fluency: english_level & parent_education: highest_degree_completed
  + summary with quantitative and categorical variable = bar graph

##### Bar Graph of Parents Education and whether or not they've taken a parenting class
```{r}
# join the parent education and parent english fluency tables 
parent_edu_eng <- left_join(parent_education, parent_english_fluency, by = c("par_id", "child_id", "wave"))

#this plot didn't quite work because the labels were squished

#g <- ggplot(parent_edu_eng, aes(highest_degree_completed))
#g + geom_bar(aes(fill = parenting_class_taken))

#plotting parents education with the number who have taken a parenting class
ggplot(parent_edu_eng, aes(y = highest_degree_completed)) +
 geom_bar(aes(fill = parenting_class_taken), position = position_stack(reverse = TRUE)) +
 theme(legend.position = "top")
```
This graph is interesting because it shows that the majority of parents in every education category have taken a parenting class, hence suggesting that education may be independent of the status of whether a parent has taken an education class.

##### Bar Graph showing Education level of English Comprehension in Parents
```{r}
#parent_edu_eng %>% 
#  glimpse()

ggplot(parent_edu_eng) +       # reference to data
  geom_bar(                 # geometry - a shape
    aes(x = understanding_english,   # aesthetics - x, y, and color values
        fill = highest_degree_completed)   
  )
```

No surprises here, the parents who understood English very well were also the parents who had more education than other categories. Although there are many NA responses in terms of education for the parents who understood English very well, this may suggest that english speakers were more self conscious of reporting their education achievement.

##### Bar Graph of English Level and Whether a Parent has taken a Parenting Class
```{r}
#violin plots show ddensity
ggplot(parent_edu_eng,
       aes(x = parenting_class_taken,
           y = english_level))  +
  geom_violin()
```


This is an interesting visualization, it seems to suggest that parents who had lower levels of english were also less likely to have taken a parenting class, as the neck of the false violin plot is thicker than that of the true violin plot. Additionally, the NA plot is somewhat constant across all levels of english suggesting that it wasn't english proficiency that dictated whether a parent took a parenting class.

##### Bar Graph of highest parent education, parent child language and media use
```{r}
edu_demo <- full_join(parent_education, parent_demographic, by = c("par_id", "child_id"))

edu_demo_media <- full_join(edu_demo, media_tech_cleaned, by = c("par_id", "child_id"))

#edu_demo_media %>% 
#  glimpse()

#create vertical side-by-side boxplots
ggplot(edu_demo_media, 
       aes(x = daily_use, 
           y = highest_degree_completed, 
           fill=chi_par_lang)) +
  geom_boxplot() +
  ggtitle('Child Daily Media Use and Highest Degree Completed by Parents') 
```

```{r}
valuable_dataset = inner_join(media_tech_cleaned, parent_education, by=c("child_id", "par_id")) 
valuable_dataset= inner_join(valuable_dataset, parent_demographic, by=c("child_id", "par_id"))  
valuable_dataset  = inner_join(valuable_dataset, model_score, by=c("child_id", "par_id"))
valuable_dataset = inner_join(valuable_dataset, public_assistance_w1, by=c("child_id", "par_id"))
valuable_dataset = inner_join(valuable_dataset, access_to_childcare_w1, by=c("child_id", "par_id")) 
valuable_dataset = inner_join(valuable_dataset, income_w1, by=c("child_id", "par_id")) 
valuable_dataset = inner_join(valuable_dataset, parent_english_fluency, 
                              by = c("child_id", "par_id"))
```

# save data back to file

```{r}
saveRDS(model_w2, file="../data/model_w2.dta")
saveRDS(model_w6, file="../data/model_w6.dta")
saveRDS(valuable_dataset, file="../data/valuable_dataset.dta")
```


---

According to Dr. Reich's email here are some preliminary exploratory data analysis here are some relationships that may be of interest:

* Are the English scores of the parent related to the standardized expressive or auditory comprehension scores?
  + model_score
  + parent_english_fluency
  
* are solo/passive/coop infant media measurements related to parent's education attainment?
  + media_tech_cleaned
  + parent_education
  
---

### Aubree Visualization 
```{r}
valuable_dataset = inner_join(media_tech_cleaned, parent_education, by=c("child_id", "par_id")) 
valuable_dataset = inner_join(valuable_dataset, income_w1, by=c("child_id", "par_id"))

valuable_dataset %>% 
         ggplot(aes(x = positive_beliefs_media,
             y = household_income_numerical,
             fill = parenting_class_taken)) +
  geom_boxplot()


```
