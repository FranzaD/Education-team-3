---
title: "Exploratory Data Analysis"
author: "Nicholas Noel"
date: '2022-06-28'
output: html_document
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)
```

```{r}
library(haven)
library(readxl)
library(ggplot2)
library(tidyverse)
library(dplyr)
library(janitor)
demographic_background <- read_dta("../data/wave-1-(9-mo)/1_DEM_w1.dta")
media_tech <- read_dta("../data/wave-1-(9-mo)/10_MT_w1.dta")
overall_background <- read_dta("../data/wave-1-(9-mo)/2_BCK_w1.dta")
scores_w1 <- read_dta("../data/wave-1-(9-mo)/26_PLS_w1.dta")
w1_codebook <- read_excel("../data/wave-1-(9-mo)/BB2_w1_codebook.xls.xlsx")

wave_2 <- read_dta("../data/wave-2-(12-mo)/31_BIT_w2.dta")
#wave_2_codebook <- read_excel("../data/wave-2-(12-mo)/BB2_w2_codebook.xls.xlsx")

wave_6 <- read_dta("../data/wave-6-(24-mo)/BB2_W6_BIT.dta")
#wave_6_codebook <- read_excel("../data/wave-6-(24-mo)/BB2_w6_BITSE_codebook.xls.xlsx")
```

# Aubree's code

```{r}

#learning to give cells names 
overall_background <- 
overall_background %>% 
  mutate(bg02a = as.factor(bg02a),
         bg02a = case_when(
           bg02a == -777 ~ "planned skip",
         bg02a == -111 ~ "drop",
         bg02a == -222 ~ "different version",
         bg02a == -333 ~ "other parent",
         bg02a == -444 ~ "unable",
         bg02a == -555 ~ "unsure",
         bg02a == -666 ~ "refused",
         bg02a == -888 ~ "error",
         bg02a == -999 ~ "missing tool") )

#subsetting data 

public_assistance_w1 <- overall_background %>% 
 mutate(parent_id = as.character(parid),
         child_id = as.character(childid),
         wave = as.factor(wave),
         par_gen = case_when(
           pargen == 0 ~ 0,
           pargen == 1 ~ 1),
         state_welfare = case_when(bg12a == 0 ~ 0,
                                   bg12a == 1~1),
         unemployment_insurance = case_when(bg12b== 0 ~ 0,
                                   bg12b == 1~1),
         food_stamp = case_when(bg12c == 0 ~ 0,
                                   bg12c == 1~1),
         wic = case_when(bg12d == 0 ~ 0,
                                   bg12d == 1~1),
         child_support = case_when(bg12e == 0 ~ 0,
                                   bg12e == 1~1),
         ssi_and_ssdi = case_when(bg12f == 0 ~ 0,
                                   bg12f == 1~1),
         adoption_assistance = case_when(bg12g == 0 ~ 0,
                                   bg12g == 1~1),
         utility_assistance = case_when(bg12h == 0 ~ 0,
                                   bg12h == 1~1), 
         childcare_subsidy = case_when(bg12i == 0 ~ 0,
                                   bg12i == 1~1),
         vertan_benefit = case_when(bg12j == 0 ~ 0,
                                   bg12j == 1~1),
         medical_assistance = case_when(bg12k == 0 ~ 0,
                                   bg12k == 1~1),
         none = case_when(bg12l == 0 ~ 0,
                                   bg12l == 1~1),
         other = case_when(bg12o == 0 ~ 0,
                                   bg12o == 1~1),
         #other_specify = as.character(bg12oxtxt),
         assistance = as.factor(assistance))

public_assistance_w1 <- public_assistance_w1%>% 
  select(parent_id, child_id, state_welfare, unemployment_insurance, food_stamp, wic,
         child_support, ssi_and_ssdi, adoption_assistance, utility_assistance, childcare_subsidy, vertan_benefit, medical_assistance, none, other, assistance)

```

# Chandra's code

```{r}
glimpse(media_tech)

```

```{r}
# total na values per column
colSums(is.na(media_tech))

# percentage na values per column
colMeans(is.na(media_tech))
```

```{r}
attributes(media_tech$mt05a)
```


# Deborah's code

```{r}

```

# James' code

## clean data

```{r}
scores_w1 <- clean_names(scores_w1)
glimpse(scores_w1)
```
```{r}
scores_w1 <-  scores_w1 %>% 
  mutate(child_id = as.character(childid),
         par_id = as.character(parid),
         pargen = as.factor(case_when(
          pargen == 1 ~ "male",
          pargen == 0 ~ "female"
        )),
        language_26_PLS_w1 = as.factor(case_when(
          language_26_pls_w1 == 0 ~ "english",
          language_26_pls_w1 == 1 ~ "spanish"
        )),
        site = as.factor(case_when(
          site == 1 ~ "UMD",
          site == 2 ~ "UCI"
        )))
```

### Variable meaning

|variable name| description|
|-------------|------------|
|childid| Child ID|
|parid| Parent ID|
|wave| wave index|
|version_26_PLS_w1| version of this form? (we definitely dont need this)|
|pargen| Parent gender|
|site | no use|
|language_26_PLS_w1| From language|
|plsacraw| Auditory Comprehension raw score|
|plsecraw| Expressive Communication raw score|
|plsraw| Total raw score (AC raw  + EC raw)|
|plsacss| Auditory Comprehension standard score|
|plsacpr| Auditory Comprehension percentile rank|
|plsecss| Expressive Communication standard score|
|plsecpr| Expressive Communication percentile rank|
|plsss| Total Standard Score|
|plspr| Total score percentile rank|

## modeling w1_scores

```{r}
model_score <- scores_w1 %>%
  select(child_id, par_id, pargen, language = language_26_PLS_w1, Auditory_Comprehension_score = plsacss, Expressive_Communication_score = plsecss, Total_score = plsss)
```


# Nick's code

```{r}

parent_demographic <- demographic_background %>%
  mutate(child_id = as.character(childid),
         par_id = as.character(parid),
         language = case_when(
           language == 1 ~1, 
           language == 0 ~ 0),
         span_lang_form = as.logical(language),
         pargen = case_when(
           pargen == 0 ~ 0,
           pargen == 1 ~ 1),
         father = as.logical(pargen),
         data_site = as.character(site),
         par_ethnicity= as.character(dem04),
         par_ethnicity = case_when(
            dem04 == 1 ~ "White",
            dem04 == 2 ~ "African American",
            dem04 == 4 ~ "Asian/Asian American",
            dem04 == 5 ~ "Middle Eastern",
            dem04 == 7 ~ "Native Haiwaiian/Pacific Islander",
            dem04 == 8 ~ "Hispanic/Latino",
            dem04 == 9 ~ "Other",
            dem04 == 10 ~ "multiracial"),
         dem05 = case_when(
           dem05 == 0 ~ 0,
           dem05 == 1 ~ 1),
         par_us_born = as.logical(dem05),
         par_language = as.character(dem06),
         par_language = case_when(
           dem06 == 1 ~ "English",
           dem06 == 2 ~ "Spanish",
           dem06 == 3 ~ "English/Spanish",
           dem06 == 5 ~ "English/Other",
           dem06 == 6 ~ "multilingual"),
         dem08 = case_when(
           dem08 == 0 ~ 0,
           dem08 == 1 ~1),
         chi_girl = as.logical(dem08),
         birth_time = case_when(
           dem10 == 1 ~ "on time",
           dem10 == 2 ~ "early",
           dem10 == 3 ~ "late"),
         dem11 = case_when(dem11 == 0 ~ 0, dem11 == 1 ~1),
         planned_preg = as.logical(dem11),
         dem16 = case_when(
           dem16 == 1 ~ "White",
           dem16 == 2 ~ "Black/AA",
           dem16 == 3 ~ "Asian",
           dem16 == 8 ~ "Hispanic/Latino",
           dem16 == 9 ~ "Other",
           dem16 == 10 ~ "Multiracial"),
         chi_ethnicity = as.character(dem16),
         dem17 = case_when(
           dem17 == 1 ~ "English",
           dem17 == 2 ~ "Spanish",
           dem17 == 3 ~ "English/Spanish",
           dem17 == 4 ~ "Vietnamese",
           dem17 == 5 ~ "English/Other", 
           dem17 == 6 ~ "Multilingual",
           dem17 == 7 ~ "Other"),
         chi_par_lang = as.character(dem17),
         dem19 = case_when(
           dem19 == 1 ~ "English",
           dem19 == 2 ~ "Spanish",
           dem19 == 3 ~ "English/Spanish",
           dem19 == 4 ~ "Vietnamese",
           dem19 == 5 ~ "English/Other",
           dem19 == 6 ~ "Multilingual",
           dem19 == 7 ~ "Other"),
         relatives_lang = as.character(dem19) ) %>% 
  select(child_id, par_id, span_lang_form, father,data_site, 
         par_ethnicity,par_us_born, par_language, chi_girl, 
         birth_time, planned_preg, chi_ethnicity, chi_par_lang, 
         relatives_lang )
  

```

```{r}
  
ggplot(data = parent_demographic, aes( 
  x= par_ethnicity)) +
geom_bar()
parent_demographic %>% 
  ggplot(aes(x = planned_preg)) + 
  geom_bar()
parent_demographic %>% 
  ggplot(aes(x = chi_ethnicity)) + 
  geom_bar()
parent_demographic %>% 
  ggplot(aes(x = chi_par_lang)) + 
  geom_bar()
parent_demographic %>% 
  ggplot(aes(x = par_language)) + 
  geom_bar()
parent_demographic %>% 
  ggplot(aes(x = par_us_born)) + 
  geom_bar()
```

# James'

```{r}
model_score_demographic = full_join(model_score, parent_demographic, by=c("child_id", "par_id"))
```

