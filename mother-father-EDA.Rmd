---
title: "mothers-fathers-EDA"
author: "Deborah Franza"
date: "2022-09-02"
output: html_document
---

#### Purpose of this file:

To showcase previous work that is applicable to current problem statements and build more EDA to be able to answer the questions Dr. Reich specified:

---
#### Problem Statements:

1.How do new mothers’ and fathers’ parenting practices around media align when their first child is 9 (W1) and 24 (W6) months of age?

2.How do mothers’ and fathers’ parenting around media relate to their child’s development of language, social skills and behavior problems?

    a.Do mothers’ and fathers’ parenting around media differentially predict child outcomes?
    
* PI wants to describe how parents agree/disagree on how they let their infants use media/ are exposed to media

---

#### Question for PI:

How are we quantifying parenting styles?
  * basing reponses off the MEDIA, TECHNOLOGY, AND YOUNG CHILDREN QUESTIONNAIRE?
  

#### Tasks:
1. determining techniques for analysis (graphs, statistics, statistical tests)
2. partitioning work effectively
3. gathering previous relevant work and building off of it
4. Consicely interpret the results of our findings
5. Clarify what specific variables Dr. Reich is interested in
    -  averages of media assessment questions
6. Clarify that she wants to be able to describe how parents agree/disagree on how they let their infants use media/ are exposed to media

#### Previous Work Relevant Towards Problem Statements| Dataframes | EDA | Statistical 

### Data
```{r}

library(forcats)
library(haven)
library(readxl)
library(ggplot2)
library(tidyverse)
library(dplyr)
library(janitor)
library(lme4)
library(lmerTest)

pls <- readRDS("../data/pls_long_rank.dta")
bit_mother <- readRDS("../data/BIT_long_mother.dta")
bit_father <- readRDS("../data/BIT_long_father.dta")
bit <- readRDS("../data/BIT_long_par.dta")
demo <- readRDS("../data/demography.dta")
media <- readRDS("../data/media_long.dta")
grouping <- readRDS("../data/grouping_data.dta")



# demo <- demo %>% 
#   transmute(par_id, child_id, 
#             bill_difficulty = as.factor(bill_difficulty),
#             marital_status = as.factor(marital_status),
#             assistance,
#             father)

#library(naniar)
#vis_miss(demo)

grouping <- grouping %>% 
  mutate(treatment = case_when(
    condition == "4" ~ " - control",
    condition == "1" ~ " - mom",
    condition == "2" ~ " - dad",
    condition == "3" ~ " - both"),
    treatment = fct_relevel(
      treatment,
      " - control",
      " - mom",
      " - dad",
      " - both"),
    control = ifelse(condition == "4", TRUE, FALSE))

pls <- pls %>%
  mutate(par_id = as.character(par_id),
         child_id = as.character(child_id))
pls %>% 
  filter(wave == 6) %>% 
  nrow()

media_pls <- media %>%
  full_join(bit, by = c("child_id", "wave")) %>% 
  full_join(pls, by = c("par_id", "child_id", "wave")) %>%
  inner_join(grouping, by = c("child_id")) %>%
  inner_join(demo, by = c("child_id", "par_id"))

media_pls_mother <- media %>%
  full_join(bit, by = c("child_id", "wave")) %>% 
  full_join(pls, by = c("par_id", "child_id", "wave")) %>%
  inner_join(grouping, by = c("child_id")) %>%
  inner_join(demo, by = c("child_id", "par_id")) %>%
  filter(par_id < 30000)

media_pls_father <- media %>%
  full_join(bit, by = c("child_id", "wave")) %>% 
  full_join(pls, by = c("par_id", "child_id", "wave")) %>%
  inner_join(grouping, by = c("child_id")) %>%
  inner_join(demo, by = c("child_id", "par_id")) %>%
  filter(par_id >= 30000)
 
demographic_background <- read_dta("../data/wave-1-(9-mo)/1_DEM_w1.dta")
media_pls <- media_pls %>% 
  inner_join(transmute(demographic_background, par_age = parage,
    child_id = as.character(childid),
      par_id = as.character(parid)), by = c("child_id", "par_id"))

media_pls1 <- media_pls %>% 
  select(plspr, behavior_management, father,wave, treatment , par_age, years_school_complete, span_lang_form, child_id) %>% 
  na.omit()

model <- media_pls1 %>% 
  lmer(plspr ~ behavior_management+ father+wave+ treatment + par_age+ years_school_complete+ span_lang_form+ (1 | child_id), REML = FALSE, data = .)

summary(model)
```

```{r}
model <- media_pls1 %>% 
  lmer(plspr ~ behavior_management+ father+wave+ treatment + par_age+ years_school_complete+ span_lang_form+ (1 | child_id), REML = FALSE, data = .)

summary(model)
```

